package cafe.deadbeef.avatar;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.awt.image.RenderedImage;
import java.io.File;
import java.io.IOException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;

import javax.imageio.ImageIO;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class EightBitAvatarService implements AvatarService {
	
	Logger logger = LoggerFactory.getLogger(this.getClass());
	
	@Autowired ColourService colourService;
	
	protected static final int[][][] faces = {
			{
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 7, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 0, 0, 0, 0 },
				{ 0, 0, 0, 7, 4, 4, 4, 4, 4, 7, 4, 4, 4, 4, 7, 4, 4, 4, 7, 0, 0, 0 },
				{ 0, 0, 7, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4, 4, 4, 7, 4, 4, 4, 7, 0, 0 },
				{ 0, 0, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 0, 0 },
				{ 0, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 0 },
				{ 0, 7, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4, 4, 4, 4, 4, 7, 4, 4, 4, 7, 0 },
				{ 0, 7, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4, 4, 4, 4, 4, 7, 4, 4, 4, 7, 0 },
				{ 0, 7, 4, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 0 },
				{ 0, 7, 4, 4, 7, 8, 8, 6, 6, 8, 8, 8, 8, 8, 8, 8, 6, 6, 8, 7, 7, 0 },
				{ 0, 7, 4, 7, 7, 8, 1, 6, 2, 1, 1, 1, 1, 1, 1, 1, 2, 6, 1, 7, 7, 0 },
				{ 0, 7, 4, 4, 7, 8, 1, 6, 6, 1, 1, 1, 1, 1, 1, 1, 6, 6, 1, 7, 7, 0 },
				{ 0, 7, 4, 4, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 0 },
				{ 0, 7, 4, 4, 7, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 7, 0 },
				{ 0, 0, 7, 7, 7, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 7, 0 },
				{ 0, 0, 7, 8, 8, 8, 1, 1, 6, 6, 6, 6, 6, 6, 6, 1, 1, 1, 1, 7, 0, 0 },
				{ 0, 0, 0, 7, 8, 8, 1, 1, 1, 6, 6, 6, 6, 6, 1, 1, 1, 1, 7, 0, 0, 0 },
				{ 0, 0, 0, 7, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 0, 0, 0 },
				{ 0, 0, 0, 0, 7, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 7, 7, 8, 1, 1, 1, 1, 1, 1, 1, 7, 7, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 7, 7, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 7, 7, 7, 7, 8, 1, 1, 1, 1, 1, 7, 7, 7, 7, 0, 0, 0, 0 },
				{ 0, 0, 0, 7, 4, 4, 4, 4, 7, 8, 1, 1, 1, 7, 4, 4, 4, 4, 7, 0, 0, 0 },
				{ 0, 0, 7, 4, 4, 4, 4, 4, 4, 7, 7, 7, 7, 4, 4, 4, 4, 4, 4, 7, 0, 0 },
				{ 0, 0, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 0, 0 },
				{ 0, 7, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4, 7, 0 },
				{ 0, 7, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 6, 6, 4, 4, 4, 4, 7, 0 }
			},
			{
				{ 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 3, 3, 1, 3, 3, 3, 1, 1, 1, 3, 3, 3, 1, 3, 3, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 3, 3, 1, 8, 8, 8, 8, 1, 1, 8, 8, 8, 1, 3, 3, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 1, 3, 1, 8, 2, 1, 8, 1, 1, 8, 2, 1, 1, 3, 1, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 1, 3, 1, 1, 2, 1, 8, 1, 1, 1, 2, 1, 1, 3, 1, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 1, 1, 1, 8, 8, 1, 1, 1, 1, 3, 3, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 6, 6, 6, 6, 6, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 6, 6, 6, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 5, 4, 4, 4, 1, 1, 1, 1, 1, 4, 4, 4, 5, 4, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 4, 4, 5, 5, 4, 4, 1, 1, 1, 4, 4, 5, 5, 4, 4, 4, 4, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 4, 4, 4, 4, 5, 5, 4, 4, 1, 4, 4, 5, 5, 4, 4, 4, 4, 4, 4, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 4, 4, 4, 4, 4, 4, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 5, 4, 4, 5, 5, 5, 4, 4, 5, 4, 4, 4, 4, 4, 4, 4, 4, 0 },
				{ 0, 4, 4, 4, 4, 4, 4, 4, 5, 4, 4, 4, 5, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 4, 4, 0 }
			},
			{
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0 },
				{ 0, 0, 3, 5, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0 },
				{ 0, 3, 3, 5, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0 },
				{ 0, 3, 3, 0, 3, 1, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 0 },
				{ 0, 3, 3, 0, 3, 1, 3, 1, 5, 2, 2, 5, 1, 5, 2, 2, 5, 0 },
				{ 0, 3, 3, 0, 0, 1, 3, 1, 5, 5, 5, 5, 1, 5, 5, 5, 5, 0 },
				{ 0, 3, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0 },
				{ 0, 3, 3, 0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0 },
				{ 0, 3, 3, 0, 4, 4, 8, 8, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 },
				{ 0, 0, 3, 4, 4, 4, 1, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 4, 4, 4, 1, 8, 8, 8, 8, 4, 4, 0, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 4, 1, 1, 1, 1, 4, 4, 4, 0, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 5, 4, 5, 1, 1, 5, 4, 5, 4, 4, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 0, 0 }
			},
			{
				{ 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0 },
				{ 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0 },
				{ 0, 0, 0, 0, 3, 3, 3, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 3, 3, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 1, 3, 1, 6, 2, 1, 6, 2, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 1, 3, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 1, 3, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 8, 8, 1, 1, 1, 1, 1, 0, 0, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 8, 8, 8, 8, 4, 4, 0, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 1, 1, 1, 4, 4, 4, 0, 0 },
				{ 0, 4, 4, 4, 4, 5, 4, 4, 4, 1, 4, 4, 5, 4, 4, 0 },
				{ 0, 4, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 5, 4, 4, 0 },
				{ 0, 4, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 5, 4, 4, 0 },
				{ 0, 4, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 5, 4, 4, 0 }
			},
			{
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 0, 0, 0, 0, 0 },
				{ 0, 0, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 0, 0, 0, 0 },
				{ 0, 0, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 0, 0, 0, 0 },
				{ 0, 0, 7, 4, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4, 7, 4, 4, 7, 0, 0, 0, 0 },
				{ 0, 0, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4, 7, 4, 4, 7, 0, 7, 0 },
				{ 0, 0, 0, 7, 7, 7, 7, 7, 7, 4, 4, 4, 4, 7, 4, 4, 7, 4, 7, 7, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 1, 7, 7, 7, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 7, 7, 1, 1, 1, 1, 7, 7, 1, 1, 7, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 7, 1, 7, 6, 2, 7, 1, 1, 7, 6, 2, 7, 1, 7, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 7, 1, 1, 7, 7, 1, 1, 1, 1, 7, 7, 1, 1, 7, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 7, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 7, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 7, 1, 7, 1, 1, 1, 1, 7, 1, 7, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 7, 1, 1, 7, 7, 7, 7, 1, 1, 7, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 7, 1, 1, 1, 1, 1, 1, 7, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0 }
			},
			{
				{ 0, 0, 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0 },
				{ 0, 0, 1, 1, 3, 3, 3, 3, 1, 1, 1, 1, 3, 3, 3, 3, 1, 1, 0 },
				{ 0, 0, 1, 1, 6, 2, 2, 6, 1, 1, 1, 1, 6, 2, 2, 6, 1, 1, 0 },
				{ 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 6, 6, 6, 6, 1, 1, 1, 1, 1, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0 },
				{ 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 4, 5, 4, 5, 1, 1, 1, 1, 4, 5, 4, 5, 0, 0, 0 },
				{ 0, 0, 0, 4, 5, 4, 5, 4, 5, 1, 1, 4, 5, 4, 5, 4, 5, 0, 0 },
				{ 0, 0, 0, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 0, 0 },
				{ 0, 0, 0, 4, 5, 4, 5, 4, 5, 1, 1, 4, 5, 4, 5, 4, 5, 0, 0 }
			},
			{
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 1, 3, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 1, 3, 3, 3, 0, 0, 0, 0 },
				{ 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 1, 3, 3, 3, 3, 3, 0, 0, 0 },
				{ 0, 0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0 },
				{ 0, 0, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 0, 0 },
				{ 0, 0, 1, 5, 6, 6, 2, 6, 5, 1, 1, 5, 6, 6, 2, 6, 5, 1, 0, 0 },
				{ 0, 0, 1, 5, 6, 6, 6, 5, 1, 1, 1, 1, 5, 6, 6, 6, 5, 1, 0, 0 },
				{ 0, 0, 0, 5, 5, 5, 5, 5, 1, 1, 1, 1, 5, 5, 5, 5, 5, 0, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 5, 5, 5, 5, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 4, 4, 4, 1, 1, 1, 1, 1, 1, 4, 4, 4, 0, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 4, 1, 1, 1, 1, 4, 4, 4, 4, 4, 0, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0 }
			},
			{
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 3, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 3, 3, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 1, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 1, 3, 1, 5, 2, 2, 5, 1, 5, 2, 2, 5, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 1, 3, 1, 5, 5, 5, 5, 1, 5, 5, 5, 5, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 0, 0, 3, 3, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 4, 4, 3, 3, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 4, 4, 4, 5, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 4, 4, 4, 5, 3, 3, 3, 3, 4, 4, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 4, 4, 4, 4, 4, 5, 1, 1, 1, 4, 4, 4, 0, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 5, 4, 5, 5, 1, 5, 4, 5, 4, 4, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 0, 0, 0 }
			},
			
			{
				{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0 },
				{ 0, 0, 0, 3, 3, 3, 3, 3, 3, 1, 3, 3, 3, 3, 0, 0, 0 },
				{ 0, 0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0 },
				{ 0, 0, 0, 1, 1, 6, 6, 1, 1, 1, 6, 6, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 1, 1, 6, 2, 1, 1, 1, 2, 6, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 1, 1, 6, 6, 1, 1, 1, 6, 6, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0 },
				{ 0, 0, 0, 0, 1, 1, 3, 1, 1, 1, 3, 1, 1, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 1, 1, 1, 3, 3, 3, 1, 1, 1, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 },
				{ 0, 0, 0, 0, 4, 4, 1, 1, 1, 1, 1, 4, 4, 0, 0, 0, 0 },
				{ 0, 0, 0, 4, 4, 4, 4, 5, 1, 5, 4, 4, 4, 4, 0, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 5, 4, 4, 4, 4, 4, 4, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0 },
				{ 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0 }
			}
		};
	
	public BufferedImage generate(int style, String hash, int scale) {
		
		int[] colours = colourService.getRealisticColours(hash);
		int[][] face = faces[style];
		
		final BufferedImage res = new BufferedImage(face[0].length * scale, face.length * scale, BufferedImage.TYPE_INT_RGB);
		for (int x = 0; x < face[0].length; x++) {
			for ( int i = 0; i < scale; i++ ) {
				for (int y = 0; y < face.length; y++) {
					
					for ( int j = 0; j < scale; j++ ) {
						res.setRGB((x*scale) + i, (y*scale) + j, colours[face[y][x]]);
					}
				}
			}
		}
		return res;
	}
	

	private void savePNG(final BufferedImage bi, final String path) {
		try {
			RenderedImage rendImage = bi;
			ImageIO.write(rendImage, "bmp", new File(path));
			// ImageIO.write(rendImage, "PNG", new File(path));
			// ImageIO.write(rendImage, "jpeg", new File(path));
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
	
	protected String md5(String input) throws NoSuchAlgorithmException {
		MessageDigest md5 = MessageDigest.getInstance("MD5");
		md5.update(input.getBytes());

		byte[] hash = md5.digest();

		StringBuffer hexString = new StringBuffer();

		for (int i = 0; i < hash.length; i++) {
			if ((0xff & hash[i]) < 0x10) {
				hexString.append("0" + Integer.toHexString((0xFF & hash[i])));
			} else {
				hexString.append(Integer.toHexString(0xFF & hash[i]));
			}
		}

		return hexString.toString();
	}


}
